<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Estuary Type Map - High Performance</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <style>
        /* Loading indicator styles */
        .loading-indicator {
            background: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>üåä Global Estuary Type Map</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link active">Map</a></li>
                <li><a href="about.html" class="nav-link">About</a></li>
                <li><a href="methodology.html" class="nav-link">Methodology</a></li>
                <li><a href="maps.html" class="nav-link">Map Collection</a></li>
                <li><a href="changelog.html" class="nav-link">Changelog</a></li>
                <li><a href="credits.html" class="nav-link">Credits</a></li>
                <li><a href="https://github.com/NguyenTruongAnLab/estuary-type-map" class="nav-link" target="_blank">GitHub ‚Üó</a></li>
            </ul>        </div>
    </nav>
    
    <div id="sidebar">
        <div class="sidebar-content">
            <h2>üìä Data Layers</h2>
            <p class="info-text">Toggle datasets on/off:</p>
            
            <div class="filter-section">
                <label class="filter-item" title="NEW! High-resolution tidal basins with D√ºrr 2011 classification (BasinATLAS Level 7, 0-300km from coast)">
                    <input type="checkbox" class="filter-checkbox" id="layer-tidal-basins" checked>
                    <span class="filter-label">üåä Tidal Basins (NEW 2025)</span>
                    <span class="count" id="count-tidal-basins">16189</span>
                </label>
                
                <label class="filter-item" title="Estuarine classification by basin (coastal areas only - LEGACY)">
                    <input type="checkbox" class="filter-checkbox" id="layer-coastal-basins">
                    <span class="filter-label">üó∫Ô∏è Estuarine Types (Legacy)</span>
                    <span class="count" id="count-coastal-basins">4536</span>
                </label>
                
                <label class="filter-item" style="opacity: 0.6;" title="Complete D√ºrr watersheds (entire drainage basins for reference)">
                    <input type="checkbox" class="filter-checkbox" id="layer-durr-reference">
                    <span class="filter-label">üìç Full D√ºrr Watersheds</span>
                    <span class="count" id="count-durr-ref">6226</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="layer-baum" checked>
                    <span class="filter-label">üíé Baum Morphometry</span>
                    <span class="count" id="count-baum-all">271</span>
                </label>
                
                <label class="filter-item" title="GlobSalt salinity monitoring stations (global network)">
                    <input type="checkbox" class="filter-checkbox" id="layer-globsalt">
                    <span class="filter-label">üî¨ GlobSalt Stations</span>
                    <span class="count" id="count-globsalt">16399</span>
                </label>
                
                <label class="filter-item" title="DynQual global river discharge & salinity (Jones et al. 2023)">
                    <input type="checkbox" class="filter-checkbox" id="layer-dynqual">
                    <span class="filter-label">üìä DynQual Rivers (Global)</span>
                    <span class="count" id="count-dynqual">5000</span>
                </label>
                
                <label class="filter-item" title="Global Coastal Characteristics (Athanasiou et al. 2024)">
                    <input type="checkbox" class="filter-checkbox" id="layer-gcc">
                    <span class="filter-label">ÔøΩ GCC Coastal Segments</span>
                    <span class="count" id="count-gcc">1252</span>
                </label>
            </div>
            
            <h2>üó∫Ô∏è Estuary Types</h2>
            <p class="info-text">Filter by geomorphological classification (coastal only):</p>
            
            <div class="filter-section">
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-all" checked>
                    <span class="filter-label all">All Types</span>
                    <span class="count" id="count-durr-all">6226</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-delta" checked>
                    <span class="filter-label delta">Delta</span>
                    <span class="count" id="count-durr-delta">0</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-coastal-plain" checked>
                    <span class="filter-label coastal-plain">Coastal Plain</span>
                    <span class="count" id="count-durr-coastal-plain">0</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-fjord" checked>
                    <span class="filter-label fjord">Fjord</span>
                    <span class="count" id="count-durr-fjord">0</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-lagoon" checked>
                    <span class="filter-label lagoon">Lagoon</span>
                    <span class="count" id="count-durr-lagoon">0</span>
                </label>
                
                <label class="filter-item">
                    <input type="checkbox" class="filter-checkbox" id="filter-durr-karst" checked>
                    <span class="filter-label karst">Karst</span>
                    <span class="count" id="count-durr-karst">0</span>
                </label>
            </div>
            
            <div class="definitions-section">
                <div class="reference-section">
                    <h4>üìö Data Sources</h4>
                    <div class="reference" style="background: #fff3cd; border-left: 4px solid #ff9800;">
                        <strong>D√ºrr et al. (2011)</strong><br>
                        <em>Estuaries and Coasts</em><br>
                        DOI: 10.1007/s12237-011-9381-y<br>
                        Two versions: Coastal + Full Watershed
                    </div>
                    <div class="reference">
                        <strong>BasinATLAS v1.0</strong><br>
                        <em>HydroSHEDS Level 7</em><br>
                        Fine-resolution coastal basins
                    </div>
                    <div class="reference">
                        <strong>Baum et al. (2024)</strong><br>
                        <em>Geomorphology</em><br>
                        Large estuary morphometry
                    </div>
                    <div class="reference">
                        <strong>GlobSalt v2.0</strong><br>
                        <em>Global river salinity</em><br>
                        22,937 monitoring stations
                    </div>
                    <div class="reference">
                        <strong>Jones et al. (2023)</strong><br>
                        <em>DynQual - Global 10km</em><br>
                        Discharge & salinity data
                    </div>
                    <div class="reference">
                        <strong>Athanasiou et al. (2024)</strong><br>
                        <em>Global Coastal Characteristics</em><br>
                        DOI: 10.5281/zenodo.8200199
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 15px; padding: 12px; background: #e3f2fd; border-radius: 6px; font-size: 0.9em;">
                    <strong>üåü Complete Global Coverage!</strong><br>
                    All major estuary and coastal datasets integrated
                    <ul style="margin: 8px 0 0 20px; padding: 0;">
                        <li>6,226+ estuaries worldwide</li>
                        <li>22K+ salinity stations</li>
                        <li>10km river characteristics</li>
                        <li>728K coastal segments</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div id="map">
        <div id="legend" class="legend">
            <h4 id="legend-title">Map Legend</h4>
            <div id="legend-content"></div>
        </div>
    </div>
    
    <!-- Pie Chart Stats Overlay -->
    <div id="stats-overlay" class="stats-overlay">
        <div class="stats-header">
            <h3>üìä Surface Area Distribution</h3>
            <button id="toggle-stats" class="stats-toggle">‚ñº</button>
        </div>
        <div class="stats-content" id="stats-content">
            <canvas id="pieChart" width="280" height="280"></canvas>
            <div id="stats-legend" class="stats-legend"></div>
        </div>
    </div>
    
    <!-- Custom JavaScript - COMPLETE FINAL VERSION WITH TIDAL ZONES -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/map.js"></script>
</body>
</html>
